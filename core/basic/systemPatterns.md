# 시스템 패턴 (System Patterns)

이 문서는 Writing Memory 시스템의 아키텍처, 주요 기술적 결정 사항, 사용된 디자인 패턴, 그리고 컴포넌트 관계를 설명합니다.

## 시스템 아키텍처

Writing Memory 시스템은 파일 기반의 분산형 아키텍처를 채택합니다. 모든 데이터와 컨텍스트는 마크다운 파일 형태로 로컬 파일 시스템에 저장됩니다. 중앙 집중식 데이터베이스나 서버 없이, 각 모드(Writing Bot)는 필요에 따라 관련 파일을 읽고 쓰면서 작업을 수행합니다.

## 주요 기술적 결정 사항

- **파일 형식:** 모든 데이터는 인간이 읽고 쓰기 쉬운 마크다운 형식을 사용합니다.
- **저장 위치:** 모든 파일은 미리 정의된 디렉토리 구조에 따라 로컬 파일 시스템에 저장됩니다.
- **처리 방식:** 각 모드는 파일 내용을 직접 파싱하고 분석하여 필요한 정보를 추출하고 업데이트합니다.
- **문맥 관리:** `activeContext.md` 및 `progress.md`와 같은 핵심 파일을 통해 현재 작업의 문맥과 진행 상황을 추적합니다.

## 사용된 디자인 패턴

- **파일 기반 데이터 관리:** 데이터를 파일 시스템에 저장하고 관리하는 기본적인 패턴을 사용합니다.
- **컨텍스트 기반 처리:** 현재 작업의 문맥을 담고 있는 파일을 참조하여 작업의 일관성과 연속성을 유지합니다.
- **모듈화된 워크플로:** 모집, 계획, 집필, 편집, 심사, 감상 등 명확히 구분된 모드(워크플로)를 통해 복잡한 과정을 관리합니다.

## 컴포넌트 관계

- **핵심 파일:** `projectbrief.md`는 모든 파일의 기초가 되며, `productContext.md`, `systemPatterns.md`, `techContext.md`는 프로젝트의 기본 컨텍스트를 제공합니다. `activeContext.md`와 `progress.md`는 현재 상태를 추적합니다.
- **작가/편집자/심사원/독자 파일:** 각 참여자의 정보와 관련된 파일은 해당 참여자의 활동(집필, 편집, 심사, 감상)에 필요한 컨텍스트를 제공합니다.
- **소설 파일:** `proposal.md`, `design_specification.md`, `config.md`, `character.md`, `world.md`, `novel_text.md` 등은 특정 소설 프로젝트와 관련된 모든 정보를 담고 있습니다.
- **워크플로:** 각 모드는 정의된 워크플로에 따라 특정 파일들을 읽고 쓰면서 작업을 진행합니다. 예를 들어, 집필 모드는 작가 파일과 소설 파일을 참조하여 `novel_text.md`를 작성합니다.

## 고급 상호작용 및 컨텍스트 관리

### Writing Memory의 캐노니컬 정보 소스 역할 (NMB 개념)
Writing Memory를 구성하는 파일들은 작가에 의해 관리되는 프로젝트의 공식적이고 중심적인 정보 저장소(Narrative Memory Bank와 유사한 역할)로 간주됩니다. Writing Bot은 이 정보들을 작업의 가장 중요한 기준으로 삼아 일관성과 깊이를 유지합니다.

### 명시적 컨텍스트 포커싱 가이드라인
- **목적**: 작가님께서 특정 정보에 대한 심층 분석이나 활용을 원하실 때, Writing Bot의 주의를 해당 정보로 집중시키기 위한 선택적 도구입니다.
- **사용법**: 메시지 내에 `[집중: 파일경로#헤더명]` (예: `[집중: novels/NOVEL_CODE/character.md#주인공의_숨겨진_과거]`) 형식을 사용하여 요청할 수 있습니다.
- **Writing Bot의 작동 방식**:
    - 지정된 컨텍스트를 최우선으로 검토하고 깊이 있게 분석합니다.
    - 이는 Writing Bot의 폭넓은 자료 조사 능력이나 Writing Memory 전체를 활용하는 능력을 제한하는 것이 아닙니다.
    - 필요하다고 판단될 경우, 지정된 컨텍스트 외에도 관련된 다른 정보를 종합적으로 고려하여 더 풍부하고 창의적인 결과물을 제시할 수 있습니다. (예: "작가님께서 지정해주신 `[X]` 내용을 중심으로 검토하였으나, 추가적으로 `[Y]` 파일의 내용도 함께 고려하여...")
- **균형**: 이 기능은 작가님의 의도를 더 정확히 파악하고 구체적인 요구에 부응하기 위함이며, Writing Bot의 창의성이나 종합적 분석 능력을 저해하지 않는 방향으로 운영됩니다.